<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Infografis Interaktif: Belajar Fungsi LookUp di Excel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://css.gg/css?=|check|code|bolt|briefcase|danger" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            scroll-behavior: smooth;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }
        .excel-grid {
            display: grid;
            border-left: 1px solid #d1d5db;
            border-top: 1px solid #d1d5db;
            width: fit-content;
        }
        .excel-cell {
            background-color: white;
            padding: 0.5rem;
            font-size: 0.875rem;
            min-height: 38px;
            display: flex;
            align-items: center;
            border-right: 1px solid #d1d5db;
            border-bottom: 1px solid #d1d5db;
            transition: background-color: 0.3s ease-in-out;
        }
        .excel-header {
            background-color: #f3f4f6;
            font-weight: bold;
            text-align: center;
            justify-content: center;
        }
        .interactive-input {
            width: 100%;
            border: 2px solid #58508d;
            border-radius: 0.375rem;
            padding: 0.25rem 0.5rem;
        }
         .interactive-input:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(88, 80, 141, 0.3);
        }
        .highlight-range {
            background-color: rgba(200, 220, 255, 0.5) !important;
        }
        .highlight-result-range {
             background-color: rgba(200, 255, 220, 0.5) !important;
        }
        .highlight {
            background-color: rgba(255, 234, 0, 0.5) !important;
        }
        .formula-part {
            font-weight: bold;
            color: #003f5c;
        }
        .formula-input {
            font-family: monospace;
            color: #003f5c;
            background-color: #eef2ff;
        }
        .info-box {
            background-color: #f7f7f9;
            border-left: 4px solid #58508d;
            padding: 1rem;
            margin-bottom: 1.5rem;
        }
        .tab-button {
            padding: 0.75rem 1.5rem;
            cursor: pointer;
            font-weight: 600;
            border-bottom: 4px solid transparent;
            transition: all 0.3s ease;
            color: #4b5563;
        }
        .tab-button.active-tab {
            color: #9b5de5;
            border-bottom-color: #9b5de5;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="container mx-auto p-4 md:p-8">

        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-6xl font-black text-[#003f5c] mb-2">Pusing Cari Data di Excel?</h1>
            <p class="text-xl md:text-2xl text-[#58508d]">Kenali Jagoan Pencari Data: Fungsi <span class="font-bold">LOOKUP</span>!</p>
        </header>

        <main class="space-y-10">

            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-2xl font-bold text-[#003f5c] mb-4">Apa itu Fungsi LookUp?</h2>
                <p class="text-base">Bayangkan kamu punya asisten super cepat. Kamu sebut nama, dia langsung berikan infonya. Itulah fungsi <span class="font-bold">LookUp</span> di Excel. Ia bertugas untuk mencari sebuah nilai (kata kunci) di dalam tabel, lalu mengambil data lain yang berhubungan dari baris atau kolom yang sama. Lupakan cara manual, saatnya bekerja cerdas!</p>
            </div>

            <!-- VLOOKUP Section -->
            <div id="vlookup-playground" class="bg-white rounded-lg shadow-lg p-6 scroll-mt-20">
                <h2 class="text-2xl font-bold text-center text-[#bc5090] mb-2">Arena Praktik: VLOOKUP (Si Vertikal)</h2>
                <p class="text-center text-gray-600 mb-8">Mencari data di tabel yang disusun menurun (datanya vertikal). Ini rumus paling populer yang wajib kamu kuasai!</p>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8 text-sm">
                    <div class="bg-white rounded-lg shadow-md p-4 transition-transform hover:scale-105 hover:shadow-xl border-t-4 border-[#bc5090]">
                        <div class="flex items-center justify-center mb-3">
                            <i class="gg-bolt text-3xl text-[#bc5090]"></i>
                            <h3 class="font-bold text-lg text-gray-800 ml-2">Intinya Buat Apa?</h3>
                        </div>
                        <p>Ini caramu bilang ke Excel: "Woi Excel, cariin dong nama barangnya apa, tapi aku cuman punya kode 'P005' di kolom ID!"</p>
                    </div>
                    <div class="bg-white rounded-lg shadow-md p-4 transition-transform hover:scale-105 hover:shadow-xl border-t-4 border-[#bc5090]">
                        <div class="flex items-center justify-center mb-3">
                            <i class="gg-briefcase text-3xl text-[#bc5090]"></i>
                            <h3 class="font-bold text-lg text-gray-800 ml-2">Dipakai di Kerjaan Buat?</h3>
                        </div>
                        <p>Buat nyari harga barang dari kodenya, atau ngambil data karyawan dari NIK-nya. Pokoknya, buat nyocokin data dari dua tabel berbeda!</p>
                    </div>
                    <div class="bg-white rounded-lg shadow-md p-4 transition-transform hover:scale-105 hover:shadow-xl border-t-4 border-yellow-500">
                        <div class="flex items-center justify-center mb-3">
                            <i class="gg-danger text-3xl text-yellow-500"></i>
                            <h3 class="font-bold text-lg text-gray-800 ml-2">Awas, Jangan Kejebak!</h3>
                        </div>
                        <p>Aturan sakral VLOOKUP: kolom tempat kamu nyari/Sel Acuan **HARUS** di paling kiri. Gak bisa ditawar! Plus, kalau nambah kolom, hitunganmu bisa berantakan.</p>
                    </div>
                </div>

                <div class="mb-8 border-b pb-6">
                    <h3 class="font-bold text-lg text-[#bc5090] mb-3">Bedah Rumus VLOOKUP</h3>
                    <p class="bg-gray-100 p-3 rounded-md text-center text-sm mb-4">
                        <code class="break-words">=VLOOKUP(<span class="formula-part">nilai_dicari</span>; <span class="formula-part">tabel_data</span>; <span class="formula-part">kolom_ke_berapa</span>; <span class="formula-part">FALSE</span>)</code>
                    </p>
                    <ul class="text-sm space-y-2">
                        <li><span class="formula-part">nilai_dicari</span>: "Kata kunci" yang mau kamu cari (misal: "P005").</li>
                        <li><span class="formula-part">tabel_data</span>: Area tabel tempat datamu berada (ditandai <span class="inline-block w-3 h-3 bg-blue-200 align-middle"></span> biru). Kolom <span class="font-bold">nilai_dicari</span> harus ada di paling kiri area ini.</li>
                        <li><span class="formula-part">kolom_ke_berapa</span>: Kamu mau ambil data dari kolom ke berapa (dihitung dari kiri, kolom pertama = 1, kedua = 2, dst).</li>
                        <li><span class="formula-part">FALSE</span>: Perintah agar Excel mencari yang sama persis. Hampir selalu pakai ini.</li>
                    </ul>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-5 gap-8">
                    <div class="lg:col-span-2">
                        <div class="bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg p-4 space-y-4">
                            <div>
                                <label for="vlookup-search-value" class="font-semibold block mb-1">1. Cari ID Produk:</label>
                                <input type="text" id="vlookup-search-value" placeholder="Ketik: P005" class="interactive-input">
                            </div>
                            <div>
                                <label for="vlookup-range-input" class="font-semibold block mb-1">2. Di Tabel Mana? (Range):</label>
                                <input type="text" id="vlookup-range-input" class="interactive-input formula-input">
                            </div>
                            <div>
                                <label for="vlookup-index-num" class="font-semibold block mb-1">3. Ambil Data dari Kolom ke-?</label>
                                <input type="number" id="vlookup-index-num" value="2" min="1" max="10" class="interactive-input">
                            </div>
                            <div>
                                <p class="font-semibold">Rumus (Bisa Diedit):</p>
                                <input type="text" id="vlookup-formula-input" class="interactive-input formula-input w-full p-2 rounded-md text-sm break-words">
                            </div>
                            <div>
                                <p class="font-semibold">Hasil:</p>
                                <div id="vlookup-result-output" class="bg-green-100 border border-green-400 p-2 rounded-md font-bold text-green-800 min-h-[40px]"></div>
                            </div>
                        </div>
                    </div>
                    <div class="lg:col-span-3 overflow-x-auto">
                        <p class="font-semibold mb-2 text-center">Tabel Inventaris Barang</p>
                        <div id="vlookup-worksheet" class="mx-auto"></div>
                    </div>
                </div>
            </div>
            
            <!-- HLOOKUP Section -->
            <div id="hlookup-playground" class="bg-white rounded-lg shadow-lg p-6 scroll-mt-20">
                <h2 class="text-2xl font-bold text-center text-[#ff6361] mb-2">Arena Praktik: HLOOKUP (Si Horizontal)</h2>
                <p class="text-center text-gray-600 mb-8">Kembaran VLOOKUP, tapi untuk tabel yang disusun mendatar. Jarang dipakai, tapi penting untuk diketahui.</p>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8 text-sm">
                    <div class="bg-white rounded-lg shadow-md p-4 transition-transform hover:scale-105 hover:shadow-xl border-t-4 border-[#ff6361]">
                        <div class="flex items-center justify-center mb-3">
                            <i class="gg-bolt text-3xl text-[#ff6361]"></i>
                            <h3 class="font-bold text-lg text-gray-800 ml-2">Intinya Buat Apa?</h3>
                        </div>
                        <p>Ini VLOOKUP versi rebahan (mendatar). Bedanya, kayak kamu punya tabel horizontal yang Judul Tabelnya di sebalah kiri atau kanan, trus kamu minta tolong buat nyariin data berdasarkan Nilai tertentu.</p>
                    </div>
                    <div class="bg-white rounded-lg shadow-md p-4 transition-transform hover:scale-105 hover:shadow-xl border-t-4 border-[#ff6361]">
                        <div class="flex items-center justify-center mb-3">
                            <i class="gg-briefcase text-3xl text-[#ff6361]"></i>
                            <h3 class="font-bold text-lg text-gray-800 ml-2">Dipakai di Kerjaan Buat?</h3>
                        </div>
                        <p>Saat kamu punya tabel jadwal mingguan atau rekap penjualan tahunan, di mana bulan atau harinya jadi judul di baris atas.</p>
                    </div>
                    <div class="bg-white rounded-lg shadow-md p-4 transition-transform hover:scale-105 hover:shadow-xl border-t-4 border-yellow-500">
                        <div class="flex items-center justify-center mb-3">
                            <i class="gg-danger text-3xl text-yellow-500"></i>
                            <h3 class="font-bold text-lg text-gray-800 ml-2">Awas, Jangan Kejebak!</h3>
                        </div>
                        <p>Aturan sakralnya sama kayak VLOOKUP tapi versi baris: baris pencarian/Sel Acuan **HARUS** di paling atas. Kaku juga, jadi hati-hati!</p>
                    </div>
                </div>

                <div class="mb-8 border-b pb-6">
                    <h3 class="font-bold text-lg text-[#ff6361] mb-3">Bedah Rumus HLOOKUP</h3>
                    <p class="bg-gray-100 p-3 rounded-md text-center text-sm mb-4">
                        <code class="break-words">=HLOOKUP(<span class="formula-part">nilai_dicari</span>; <span class="formula-part">tabel_data</span>; <span class="formula-part">baris_ke_berapa</span>; <span class="formula-part">FALSE</span>)</code>
                    </p>
                     <ul class="text-sm space-y-2">
                        <li><span class="formula-part">nilai_dicari</span>: "Kata kunci" yang mau kamu cari (misal: "P007").</li>
                        <li><span class="formula-part">tabel_data</span>: Area tabel tempat datamu berada (ditandai <span class="inline-block w-3 h-3 bg-blue-200 align-middle"></span> biru). Baris <span class="font-bold">nilai_dicari</span> harus ada di paling atas area ini.</li>
                        <li><span class="formula-part">baris_ke_berapa</span>: Kamu mau ambil data dari baris ke berapa (dihitung dari atas, baris pertama = 1, kedua = 2, dst).</li>
                        <li><span class="formula-part">FALSE</span>: Perintah agar Excel mencari yang sama persis.</li>
                    </ul>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-5 gap-8">
                    <div class="lg:col-span-2">
                         <div class="bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg p-4 space-y-4">
                            <div>
                                <label for="hlookup-search-value" class="font-semibold block mb-1">1. Cari ID Produk:</label>
                                <input type="text" id="hlookup-search-value" placeholder="Ketik: P007" class="interactive-input">
                            </div>
                            <div>
                                <label for="hlookup-range-input" class="font-semibold block mb-1">2. Di Tabel Mana? (Range):</label>
                                <input type="text" id="hlookup-range-input" class="interactive-input formula-input">
                            </div>
                            <div>
                                <label for="hlookup-index-num" class="font-semibold block mb-1">3. Ambil Data dari Baris ke-?</label>
                                <input type="number" id="hlookup-index-num" value="2" min="1" max="10" class="interactive-input">
                            </div>
                            <div>
                                <p class="font-semibold">Rumus (Bisa Diedit):</p>
                                <input type="text" id="hlookup-formula-input" class="interactive-input formula-input w-full p-2 rounded-md text-sm break-words">
                            </div>
                            <div>
                                <p class="font-semibold">Hasil:</p>
                                <div id="hlookup-result-output" class="bg-green-100 border border-green-400 p-2 rounded-md font-bold text-green-800 min-h-[40px]"></div>
                            </div>
                        </div>
                    </div>
                    <div class="lg:col-span-3 overflow-x-auto">
                        <p class="font-semibold mb-2 text-center">Tabel Inventaris Barang</p>
                        <div id="hlookup-worksheet" class="mx-auto"></div>
                    </div>
                </div>
            </div>

            <!-- XLOOKUP Section -->
            <div id="xlookup-playground" class="bg-white rounded-lg shadow-lg p-6 scroll-mt-20">
                <h2 class="text-2xl font-bold text-center text-[#ffa600] mb-2">Arena Praktik: XLOOKUP (Si Fleksibel)</h2>
                <p class="text-center text-gray-600 mb-8">Jagoan baru yang lebih pintar dan anti ribet. Jika Excel-mu mendukung, lupakan VLOOKUP dan mulailah pakai ini!</p>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8 text-sm">
                    <div class="bg-white rounded-lg shadow-md p-4 transition-transform hover:scale-105 hover:shadow-xl border-t-4 border-[#ffa600]">
                        <div class="flex items-center justify-center mb-3">
                            <i class="gg-bolt text-3xl text-[#ffa600]"></i>
                            <h3 class="font-bold text-lg text-gray-800 ml-2">Intinya Buat Apa?</h3>
                        </div>
                        <p>Ini jagoan super! Gak peduli kolomnya di kiri atau kanan, Vertikal atau Horizontal, mau nyari ke mana aja, ambil data dari mana aja, sikat! Jauh lebih simpel dan anti-pusing.</p>
                    </div>
                    <div class="bg-white rounded-lg shadow-md p-4 transition-transform hover:scale-105 hover:shadow-xl border-t-4 border-[#ffa600]">
                        <div class="flex items-center justify-center mb-3">
                            <i class="gg-briefcase text-3xl text-[#ffa600]"></i>
                            <h3 class="font-bold text-lg text-gray-800 ml-2">Dipakai di Kerjaan Buat?</h3>
                        </div>
                        <p>Untuk semua hal yang VLOOKUP & HLOOKUP bisa, TAPI lebih hebat. Contohnya, nyari ID produk dari NAMA produknya (dibalik balik) tetep bisa.</p>
                    </div>
                    <div class="bg-white rounded-lg shadow-md p-4 transition-transform hover:scale-105 hover:shadow-xl border-t-4 border-yellow-500">
                        <div class="flex items-center justify-center mb-3">
                            <i class="gg-danger text-3xl text-yellow-500"></i>
                            <h3 class="font-bold text-lg text-gray-800 ml-2">Awas, Jangan Kejebak!</h3>
                        </div>
                        <p>Satu-satunya kelemahan: cuma ada di Excel 2021/365. Kalau teman kantormu pakai Excel jadul, rumus ini bakal error di komputernya.</p>
                    </div>
                </div>
                
                <div class="mb-8 border-b pb-6">
                    <h3 class="font-bold text-lg text-[#ffa600] mb-3">Bedah Rumus XLOOKUP</h3>
                    <p class="bg-gray-100 p-3 rounded-md text-center text-sm mb-4">
                        <code class="break-words">=XLOOKUP(<span class="formula-part">nilai_dicari</span>; <span class="formula-part">kolom_pencarian</span>; <span class="formula-part">kolom_hasil</span>)</code>
                    </p>
                    <ul class="text-sm space-y-2">
                        <li><span class="formula-part">nilai_dicari</span>: "Kata kunci" yang mau kamu cari (misal: "P010").</li>
                        <li><span class="formula-part">kolom_pencarian</span>: Cukup blok <span class="font-bold">satu kolom</span> tempat kamu mencari (ditandai <span class="inline-block w-3 h-3 bg-blue-200 align-middle"></span> biru). Tidak harus di paling kiri!</li>
                        <li><span class="formula-part">kolom_hasil</span>: Cukup blok <span class="font-bold">satu kolom</span> tempat data yang mau kamu ambil berada (ditandai <span class="inline-block w-3 h-3 bg-green-200 align-middle"></span> hijau).</li>
                    </ul>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-5 gap-8">
                    <div class="lg:col-span-2">
                         <div class="bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg p-4 space-y-4">
                            <div>
                                <label for="xlookup-search-value" class="font-semibold block mb-1">1. Cari Nilai Apa?:</label>
                                <input type="text" id="xlookup-search-value" placeholder="Ketik: P010" class="interactive-input">
                            </div>
                            <div>
                                <label for="xlookup-search-range" class="font-semibold block mb-1">2. Cari di Kolom Mana? (Range):</label>
                                <input type="text" id="xlookup-search-range" class="interactive-input formula-input">
                            </div>
                            <div>
                                <label for="xlookup-result-range" class="font-semibold block mb-1">3. Ambil Hasil dari Kolom? (Range):</label>
                                <input type="text" id="xlookup-result-range" class="interactive-input formula-input">
                            </div>
                            <div>
                                <p class="font-semibold">Rumus (Bisa Diedit):</p>
                                <input type="text" id="xlookup-formula-input" class="interactive-input formula-input w-full p-2 rounded-md text-sm break-words">
                            </div>
                            <div>
                                <p class="font-semibold">Hasil:</p>
                                <div id="xlookup-result-output" class="bg-green-100 border border-green-400 p-2 rounded-md font-bold text-green-800 min-h-[40px]"></div>
                            </div>
                        </div>
                    </div>
                    <div class="lg:col-span-3 overflow-x-auto">
                        <p class="font-semibold mb-2 text-center">Tabel Inventaris Barang</p>
                        <div id="xlookup-worksheet" class="mx-auto"></div>
                    </div>
                </div>
            </div>

            <!-- Combined Multi-Criteria Section -->
            <div id="combined-multicriteria-playground" class="bg-white rounded-lg shadow-lg p-6 scroll-mt-20">
                <h2 class="text-2xl font-bold text-center text-purple-600 mb-2">Level Up: Mencari dengan Dua Kriteria!</h2>
                <p class="text-center text-gray-600 mb-8">Satu kriteria kurang? Tenang, VLOOKUP dan XLOOKUP punya jurus rahasia masing-masing. Pilih jurusmu!</p>

                <!-- Tab Buttons -->
                <div class="flex justify-center mb-6 border-b-2 border-gray-200">
                    <button id="show-xlookup-mc" class="tab-button active-tab">
                        Jurus XLOOKUP (Modern)
                    </button>
                    <button id="show-vlookup-mc" class="tab-button">
                        Jurus VLOOKUP (Klasik)
                    </button>
                </div>

                <!-- Content Panels -->
                <div>
                    <!-- XLOOKUP Panel -->
                    <div id="xlookup-mc-content">
                        <div class="mb-8 border-b pb-6">
                            <h3 class="font-bold text-lg text-purple-600 mb-3">Jurus XLOOKUP Multi-Kriteria</h3>
                            <p class="mb-4 text-sm">Masalahnya: Di tabel kita ada dua "Mouse Optik G5", satu kategori "Aksesoris", satu lagi "Gaming". Kita mau cari harga yang "Gaming". Caranya?</p>
                            <p class="bg-gray-100 p-3 rounded-md text-center text-sm mb-4">
                                <code class="break-words">=XLOOKUP(<span class="formula-part">1</span>, (<span class="formula-part">range1</span>=<span class="formula-part">kriteria1</span>)*(<span class="formula-part">range2</span>=<span class="formula-part">kriteria2</span>), <span class="formula-part">range_hasil</span>)</code>
                            </p>
                            <ul class="text-sm space-y-2">
                                <li><span class="formula-part">1</span>: Kita mencari hasil dari perkalian logika. Anggap saja kita mencari baris yang hasilnya "BENAR".</li>
                                <li>(<span class="formula-part">range1</span>=<span class="formula-part">kriteria1</span>): Excel akan cek setiap baris, mana yang cocok dengan kriteria pertama (hasilnya BENAR/SALAH).</li>
                                <li>* (<span class="formula-part">range2</span>=<span class="formula-part">kriteria2</span>): Dikali dengan pengecekan kriteria kedua. Hanya baris yang <span class="font-bold">keduanya BENAR</span> yang akan dianggap sebagai <span class="font-bold">1</span> (BENAR).</li>
                                <li><span class="formula-part">range_hasil</span>: Kolom tempat data yang mau kita ambil.</li>
                            </ul>
                        </div>
                        <div class="grid grid-cols-1 lg:grid-cols-5 gap-8">
                            <div class="lg:col-span-2">
                                 <div class="bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg p-4 space-y-4">
                                    <div>
                                        <label for="mc-xlookup-search-value1" class="font-semibold block mb-1">1. Cari Nama Barang:</label>
                                        <input type="text" id="mc-xlookup-search-value1" placeholder="Mouse Optik G5" class="interactive-input">
                                    </div>
                                    <div>
                                        <label for="mc-xlookup-search-value2" class="font-semibold block mb-1">2. Dengan Kategori:</label>
                                        <input type="text" id="mc-xlookup-search-value2" placeholder="Gaming" class="interactive-input">
                                    </div>
                                     <div>
                                        <label for="mc-xlookup-result-range" class="font-semibold block mb-1">3. Ambil Hasil dari Kolom? (Range):</label>
                                        <input type="text" id="mc-xlookup-result-range" class="interactive-input formula-input">
                                    </div>
                                    <div>
                                        <p class="font-semibold">Rumus (Otomatis):</p>
                                        <div id="mc-xlookup-formula-output" class="bg-purple-100 p-2 rounded-md font-mono text-purple-800 text-xs break-words min-h-[40px]"></div>
                                    </div>
                                    <div>
                                        <p class="font-semibold">Hasil:</p>
                                        <div id="mc-xlookup-result-output" class="bg-green-100 border border-green-400 p-2 rounded-md font-bold text-green-800 min-h-[40px]"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="lg:col-span-3 overflow-x-auto">
                                <p class="font-semibold mb-2 text-center">Tabel Inventaris Barang (dengan data kembar)</p>
                                <div id="mc-xlookup-worksheet" class="mx-auto"></div>
                            </div>
                        </div>
                    </div>

                    <!-- VLOOKUP Panel -->
                    <div id="vlookup-mc-content" class="hidden">
                        <div class="mb-8 border-b pb-6">
                            <h3 class="font-bold text-lg text-[#9b5de5] mb-3">Jurus VLOOKUP + Kolom Bantu (Helper Column)</h3>
                            <p class="mb-4 text-sm">Masalahnya sama: cari harga "Mouse Optik G5" yang kategori "Gaming". Karena VLOOKUP harus cari di kolom paling kiri, kita buat kolom baru yang isinya gabungan dua kriteria!</p>
                            <ol class="text-sm space-y-2 list-decimal list-inside">
                                <li><b>Buat Kolom Baru:</b> Di sebelah kiri tabel, kita buat kolom "Kunci Unik".</li>
                                <li><b>Gabungkan Kriteria:</b> Isi kolom baru itu dengan gabungan "Nama Barang" dan "Kategori". Contoh: "Mouse Optik G5Gaming".</li>
                                <li><b>VLOOKUP seperti Biasa:</b> Sekarang kita bisa pakai VLOOKUP untuk mencari "kunci unik" tadi di kolom bantu yang baru kita buat. Simpel kan?</li>
                            </ol>
                        </div>
                        <div class="grid grid-cols-1 lg:grid-cols-5 gap-8">
                            <div class="lg:col-span-2">
                                 <div class="bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg p-4 space-y-4">
                                    <div>
                                        <label for="mc-v-search-value1" class="font-semibold block mb-1">1. Cari Nama Barang:</label>
                                        <input type="text" id="mc-v-search-value1" placeholder="Mouse Optik G5" class="interactive-input">
                                    </div>
                                    <div>
                                        <label for="mc-v-search-value2" class="font-semibold block mb-1">2. Dengan Kategori:</label>
                                        <input type="text" id="mc-v-search-value2" placeholder="Gaming" class="interactive-input">
                                    </div>
                                    <div>
                                        <p class="font-semibold block mb-1">Kunci Unik yang Dicari:</p>
                                        <div id="mc-v-helper-key" class="bg-yellow-100 p-2 rounded-md font-mono text-yellow-800 text-sm break-words"></div>
                                        <p class="text-xs text-gray-500 mt-1 italic">Dibuat dengan rumus: <code id="mc-v-helper-formula" class="font-mono text-gray-700"></code></p>
                                    </div>
                                    <div>
                                        <label for="mc-v-index-num" class="font-semibold block mb-1">Ambil Hasil dari Kolom ke-?:</label>
                                        <input type="number" id="mc-v-index-num" value="6" min="1" max="10" class="interactive-input">
                                    </div>
                                    <div>
                                        <p class="font-semibold">Rumus (Otomatis):</p>
                                        <div id="mc-v-formula-output" class="bg-purple-100 p-2 rounded-md font-mono text-purple-800 text-xs break-words min-h-[40px]"></div>
                                    </div>
                                    <div>
                                        <p class="font-semibold">Hasil:</p>
                                        <div id="mc-v-result-output" class="bg-green-100 border border-green-400 p-2 rounded-md font-bold text-green-800 min-h-[40px]"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="lg:col-span-3 overflow-x-auto">
                                <p class="font-semibold mb-2 text-center">Tabel Inventaris dengan Kolom Bantu</p>
                                <div id="mc-vlookup-worksheet" class="mx-auto"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <!-- Kapan Harus Pakai? Section -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-2xl font-bold text-center text-[#003f5c] mb-4">Kapan Harus Pakai yang Mana?</h2>
                <p class="text-center text-gray-600 mb-8 max-w-3xl mx-auto">Setiap fungsi punya "spesialisasi"-nya masing-masing. Pilihlah yang paling sesuai dengan format tabel dan versi Excel-mu.</p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <!-- VLOOKUP Card -->
                    <div class="border-2 border-[#bc5090] rounded-lg p-4 flex flex-col">
                        <h3 class="text-xl font-bold text-[#bc5090] mb-3 text-center">VLOOKUP</h3>
                        <p class="font-semibold text-center mb-3">Gunakan Ketika...</p>
                        <p class="text-sm text-gray-700 mb-4 flex-grow">Tabel datamu tersusun **vertikal** (menurun) dan kolom pencarian berada di **paling kiri** dari area data.</p>
                        <div class="mt-auto">
                            <p class="text-xs bg-green-100 text-green-800 p-2 rounded"><span class="font-bold">Kelebihan:</span> Paling umum & banyak dikenal.</p>
                            <p class="text-xs bg-red-100 text-red-800 p-2 rounded mt-2"><span class="font-bold">Kekurangan:</span> Tidak fleksibel, rawan error jika kolom ditambah.</p>
                        </div>
                    </div>
                    <!-- HLOOKUP Card -->
                    <div class="border-2 border-[#ff6361] rounded-lg p-4 flex flex-col">
                        <h3 class="text-xl font-bold text-[#ff6361] mb-3 text-center">HLOOKUP</h3>
                        <p class="font-semibold text-center mb-3">Gunakan Ketika...</p>
                        <p class="text-sm text-gray-700 mb-4 flex-grow">Tabel datamu tersusun **horizontal** (mendatar) dan baris pencarian berada di **paling atas**.</p>
                         <div class="mt-auto">
                            <p class="text-xs bg-green-100 text-green-800 p-2 rounded"><span class="font-bold">Kelebihan:</span> Solusi untuk format tabel horizontal.</p>
                            <p class="text-xs bg-red-100 text-red-800 p-2 rounded mt-2"><span class="font-bold">Kekurangan:</span> Sama tidak fleksibelnya dengan VLOOKUP.</p>
                        </div>
                    </div>
                    <!-- XLOOKUP Card -->
                    <div class="border-2 border-[#ffa600] rounded-lg p-4 flex flex-col">
                        <h3 class="text-xl font-bold text-[#ffa600] mb-3 text-center">XLOOKUP</h3>
                        <p class="font-semibold text-center mb-3">Gunakan Ketika...</p>
                        <p class="text-sm text-gray-700 mb-4 flex-grow">Kamu ingin cara yang **paling mudah, aman, dan fleksibel**. Ini adalah pilihan terbaik jika kamu menggunakan Excel 2021 / Microsoft 365.</p>
                         <div class="mt-auto">
                            <p class="text-xs bg-green-100 text-green-800 p-2 rounded"><span class="font-bold">Kelebihan:</span> Sangat fleksibel, lebih mudah ditulis, anti error.</p>
                            <p class="text-xs bg-red-100 text-red-800 p-2 rounded mt-2"><span class="font-bold">Kekurangan:</span> Tidak tersedia di versi Excel lama.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Info Tambahan Section -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-2xl font-bold text-center text-[#003f5c] mb-4">Eh, Terus Fungsi LOOKUP Biasa ke Mana?</h2>
                <div class="max-w-3xl mx-auto text-center text-gray-700 space-y-3">
                    <p>
                        Kamu mungkin bertanya, "Kenapa gak belajar fungsi <code class="bg-gray-200 px-1 rounded-md font-mono">LOOKUP</code> yang polosan aja?". Pertanyaan bagus!
                    </p>
                    <p>
                        Anggap aja <code class="bg-gray-200 px-1 rounded-md font-mono">LOOKUP</code> itu versi "jadul"-nya. Dia punya satu kelemahan fatal: data di kolom pencariannya <span class="font-bold text-red-600">WAJIB diurutkan</span> dari A-Z atau dari kecil ke besar. Kalau datamu acak-acakan (seperti kebanyakan data di dunia nyata), <code class="bg-gray-200 px-1 rounded-md font-mono">LOOKUP</code> bisa ngasih hasil yang <span class="font-bold">salah total</span> tanpa bilang-bilang! Bahaya, kan?
                    </p>
                    <p>
                        Nah, <code class="bg-gray-200 px-1 rounded-md font-mono">VLOOKUP</code> dan <code class="bg-gray-200 px-1 rounded-md font-mono">HLOOKUP</code> (dengan <code class="bg-gray-200 px-1 rounded-md font-mono">FALSE</code> di akhir) lahir untuk memperbaiki ini. Mereka bisa mencari data yang sama persis di tabel yang acak sekalipun. Makanya, mereka jadi standar di dunia kerja.
                    </p>
                     <p class="pt-2 text-gray-500 italic">
                        Jadi, anggap aja LOOKUP itu motor tua, VLOOKUP & HLOOKUP itu motor matic, dan XLOOKUP itu mobil sport-nya!
                    </p>
                </div>
            </div>

        </main>

        <footer class="text-center mt-12 py-4 border-t border-gray-300">
            <p class="text-gray-500">Infografis dibuat untuk mempermudah belajar Excel. Selamat mencoba!</p>
        </footer>

    </div>

    <script>
        const dataVertical = {
            headers: ['', 'A', 'B', 'C', 'D', 'E'],
            rows: [
                ['1', 'ID Produk', 'Nama Barang', 'Kategori', 'Stok', 'Harga'],
                ['2', 'P001', 'Laptop Pro 15', 'Komputer', 15, 18500000],
                ['3', 'P002', 'Mouse Optik G5', 'Aksesoris', 50, 350000],
                ['4', 'P003', 'Keyboard Mekanikal', 'Aksesoris', 30, 850000],
                ['5', 'P004', 'Monitor LED 24"', 'Monitor', 25, 2500000],
                ['6', 'P005', 'Webcam HD 1080p', 'Aksesoris', 40, 650000],
                ['7', 'P006', 'Printer All-in-One', 'Printer', 20, 1750000],
                ['8', 'P007', 'Hard Disk Eksternal 1TB', 'Penyimpanan', 35, 950000],
                ['9', 'P008', 'Headset Gaming X', 'Audio', 28, 1250000],
                ['10', 'P009', 'SSD NVMe 512GB', 'Penyimpanan', 32, 1100000],
                ['11', 'P010', 'Speaker Bluetooth', 'Audio', 45, 550000],
                ['12', 'P011', 'Mouse Optik G5', 'Gaming', 25, 450000]
            ]
        };
        
        const dataVerticalWithHelper = {
            headers: ['', 'A', 'B', 'C', 'D', 'E', 'F'],
            rows: [
                ['1', 'Kunci Unik', 'ID Produk', 'Nama Barang', 'Kategori', 'Stok', 'Harga'],
                ['2', 'Laptop Pro 15Komputer', 'P001', 'Laptop Pro 15', 'Komputer', 15, 18500000],
                ['3', 'Mouse Optik G5Aksesoris', 'P002', 'Mouse Optik G5', 'Aksesoris', 50, 350000],
                ['4', 'Keyboard MekanikalAksesoris', 'P003', 'Keyboard Mekanikal', 'Aksesoris', 30, 850000],
                ['5', 'Monitor LED 24"Monitor', 'P004', 'Monitor LED 24"', 'Monitor', 25, 2500000],
                ['6', 'Webcam HD 1080pAksesoris', 'P005', 'Webcam HD 1080p', 'Aksesoris', 40, 650000],
                ['7', 'Printer All-in-OnePrinter', 'P006', 'Printer All-in-One', 'Printer', 20, 1750000],
                ['8', 'Hard Disk Eksternal 1TBPenyimpanan', 'P007', 'Hard Disk Eksternal 1TB', 'Penyimpanan', 35, 950000],
                ['9', 'Headset Gaming XAudio', 'P008', 'Headset Gaming X', 'Audio', 28, 1250000],
                ['10', 'SSD NVMe 512GBPenyimpanan', 'P009', 'SSD NVMe 512GB', 'Penyimpanan', 32, 1100000],
                ['11', 'Speaker BluetoothAudio', 'P010', 'Speaker Bluetooth', 'Audio', 45, 550000],
                ['12', 'Mouse Optik G5Gaming', 'P011', 'Mouse Optik G5', 'Gaming', 25, 450000]
            ]
        };

        const dataHorizontal = {
            headers: ['', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L'],
            rows: [
                ['1', 'ID Produk', 'P001', 'P002', 'P003', 'P004', 'P005', 'P006', 'P007', 'P008', 'P009', 'P010', 'P011'],
                ['2', 'Nama Barang', 'Laptop Pro 15', 'Mouse Optik G5', 'Keyboard Mekanikal', 'Monitor LED 24"', 'Webcam HD 1080p', 'Printer All-in-One', 'Hard Disk Eksternal 1TB', 'Headset Gaming X', 'SSD NVMe 512GB', 'Speaker Bluetooth', 'Mouse Optik G5'],
                ['3', 'Kategori', 'Komputer', 'Aksesoris', 'Aksesoris', 'Monitor', 'Aksesoris', 'Printer', 'Penyimpanan', 'Audio', 'Penyimpanan', 'Audio', 'Gaming'],
                ['4', 'Stok', 15, 50, 30, 25, 40, 20, 35, 28, 32, 45, 25],
                ['5', 'Harga', 18500000, 350000, 850000, 2500000, 650000, 1750000, 950000, 1250000, 1100000, 550000, 450000]
            ]
        };

        function createWorksheet(containerId, data) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            let html = `<div class="excel-grid" style="grid-template-columns: 40px repeat(${data.headers.length - 1}, minmax(120px, 1fr));">`;
            
            data.headers.forEach((header, headerIndex) => {
                html += `<div class="excel-cell excel-header" data-col-index="${headerIndex}" data-col-name="${header}">${header}</div>`;
            });

            data.rows.forEach((row, rowIndex) => {
                row.forEach((cell, cellIndex) => {
                    const isHeader = cellIndex === 0 || (containerId.includes('hlookup') && rowIndex === 0);
                    const cellId = `${containerId}-r${rowIndex}c${cellIndex}`;
                    let content = cell;
                    if (typeof cell === 'number' && !isHeader) {
                         const headerText = data.headers[cellIndex];
                         if(headerText === 'Harga') {
                           content = 'Rp ' + cell.toLocaleString('id-ID');
                        }
                    }
                    html += `<div class="excel-cell ${isHeader ? 'excel-header' : ''}" id="${cellId}">${content}</div>`;
                });
            });

            html += '</div>';
            container.innerHTML = html;
        }
        
        function clearHighlights(containerId) {
             document.querySelectorAll(`#${containerId} .excel-cell`).forEach(c => {
                 c.classList.remove('highlight', 'highlight-range', 'highlight-result-range');
             });
        }
        
        function colLetterToCellIndex(letter) {
            return letter.toUpperCase().charCodeAt(0) - 'A'.charCodeAt(0) + 1;
        }

        function parseRange(rangeStr) {
            const cleanRange = rangeStr.replace(/\$/g, '');
            const parts = cleanRange.split(':');
            if (parts.length !== 2) return null;

            const startMatch = parts[0].match(/([A-Z]+)(\d+)/i);
            const endMatch = parts[1].match(/([A-Z]+)(\d+)/i);
            if (!startMatch || !endMatch) return null;

            return {
                startCol: colLetterToCellIndex(startMatch[1]), 
                startRow: parseInt(startMatch[2]), 
                endCol: colLetterToCellIndex(endMatch[1]),
                endRow: parseInt(endMatch[2]),
            };
        }

        // --- VLOOKUP LOGIC ---
        const vlookupSearchInput = document.getElementById('vlookup-search-value');
        const vlookupRangeInput = document.getElementById('vlookup-range-input');
        const vlookupIndexInput = document.getElementById('vlookup-index-num');
        const vlookupFormulaInput = document.getElementById('vlookup-formula-input');
        
        function updateVlookupFormula() {
            const searchValue = vlookupSearchInput.value.trim();
            const tableRange = vlookupRangeInput.value.trim();
            const indexNum = parseInt(vlookupIndexInput.value);
            if (searchValue && tableRange) {
                vlookupFormulaInput.value = `=VLOOKUP("${searchValue}"; ${tableRange}; ${indexNum}; FALSE)`;
            } else {
                vlookupFormulaInput.value = '';
            }
            runVlookup();
        }

        function runVlookup() {
            clearHighlights('vlookup-worksheet');
            const formula = vlookupFormulaInput.value;
            const regex = /=VLOOKUP\("([^"]+)"\s*;\s*([$A-Z0-9:]+)\s*;\s*(\d+)\s*;\s*FALSE\)/i;
            const match = formula.match(regex);

            if (match) {
                const searchValue = match[1];
                const rangeStr = match[2];
                const indexNum = parseInt(match[3]);

                if(document.activeElement !== vlookupSearchInput) vlookupSearchInput.value = searchValue;
                if(document.activeElement !== vlookupRangeInput) vlookupRangeInput.value = rangeStr;
                if(document.activeElement !== vlookupIndexInput) vlookupIndexInput.value = indexNum;

                const parsedRange = parseRange(rangeStr);
                if (!parsedRange) {
                    document.getElementById('vlookup-result-output').textContent = '#ERROR!';
                    return;
                }
                
                for (let r = parsedRange.startRow -1; r <= parsedRange.endRow -1; r++) {
                    for (let c = parsedRange.startCol; c <= parsedRange.endCol; c++) {
                        const cell = document.getElementById(`vlookup-worksheet-r${r}c${c}`);
                        if(cell) cell.classList.add('highlight-range');
                    }
                }
                
                const searchColIndex = parsedRange.startCol;
                let foundRowIndex = -1;

                for (let r = parsedRange.startRow -1; r <= parsedRange.endRow -1; r++) {
                     if (dataVertical.rows[r] && dataVertical.rows[r][searchColIndex] && String(dataVertical.rows[r][searchColIndex]).toLowerCase() === searchValue.toLowerCase()) {
                        foundRowIndex = r;
                        break;
                    }
                }

                if (foundRowIndex !== -1) {
                    const resultColIndex = parsedRange.startCol + indexNum - 1;
                    if (resultColIndex >= parsedRange.startCol && resultColIndex <= parsedRange.endCol) {
                        const result = dataVertical.rows[foundRowIndex][resultColIndex];
                        let resultText = result;
                        if (typeof result === 'number') {
                             if (resultColIndex === 5) { // Harga is column E, cellIndex 5
                                resultText = 'Rp ' + result.toLocaleString('id-ID');
                            }
                        }
                        document.getElementById('vlookup-result-output').textContent = resultText;
                        
                        document.getElementById(`vlookup-worksheet-r${foundRowIndex}c${searchColIndex}`).classList.add('highlight');
                        document.getElementById(`vlookup-worksheet-r${foundRowIndex}c${resultColIndex}`).classList.add('highlight');
                    } else {
                        document.getElementById('vlookup-result-output').textContent = '#REF!';
                    }
                } else {
                    document.getElementById('vlookup-result-output').textContent = '#N/A';
                }
            } else {
                 document.getElementById('vlookup-result-output').textContent = '#ERROR!';
            }
        }
        
        // --- MULTI-CRITERIA VLOOKUP ---
        const mcVSearch1 = document.getElementById('mc-v-search-value1');
        const mcVSearch2 = document.getElementById('mc-v-search-value2');
        const mcVIndex = document.getElementById('mc-v-index-num');
        const mcVFormulaOutput = document.getElementById('mc-v-formula-output');
        const mcVResultOutput = document.getElementById('mc-v-result-output');
        const mcVHelperKey = document.getElementById('mc-v-helper-key');
        const mcVHelperFormula = document.getElementById('mc-v-helper-formula');

        function runMultiCriteriaVlookup() {
            clearHighlights('mc-vlookup-worksheet');
            const searchValue1 = mcVSearch1.value.trim();
            const searchValue2 = mcVSearch2.value.trim();
            const helperKeyValue = searchValue1 + searchValue2;
            mcVHelperKey.textContent = helperKeyValue;
            mcVHelperFormula.textContent = `="${searchValue1}"&"${searchValue2}"`;
            
            const tableRange = '$A$2:$F$12';
            const indexNum = parseInt(mcVIndex.value);

            mcVFormulaOutput.textContent = `=VLOOKUP("${helperKeyValue}"; ${tableRange}; ${indexNum}; FALSE)`;
            
            const parsedRange = parseRange(tableRange);
            if (!parsedRange) {
                mcVResultOutput.textContent = '#ERROR!';
                return;
            }

            // Highlighting
            for (let r = parsedRange.startRow - 1; r <= parsedRange.endRow - 1; r++) {
                for (let c = parsedRange.startCol; c <= parsedRange.endCol; c++) {
                    const cell = document.getElementById(`mc-vlookup-worksheet-r${r}c${c}`);
                    if (cell) cell.classList.add('highlight-range');
                }
            }
            
            const searchColIndex = 1; // Helper Column A
            let foundRowIndex = -1;

            for (let r = 1; r < dataVerticalWithHelper.rows.length; r++) {
                if (String(dataVerticalWithHelper.rows[r][searchColIndex]).toLowerCase() === helperKeyValue.toLowerCase()) {
                    foundRowIndex = r;
                    break;
                }
            }
            
            if (foundRowIndex !== -1) {
                const resultColIndex = indexNum;
                if (resultColIndex >= parsedRange.startCol && resultColIndex <= parsedRange.endCol) {
                    const result = dataVerticalWithHelper.rows[foundRowIndex][resultColIndex];
                    let resultText = result;
                    if (typeof result === 'number') {
                        if (resultColIndex === 6) { // Harga in helper table
                            resultText = 'Rp ' + result.toLocaleString('id-ID');
                        }
                    }
                    mcVResultOutput.textContent = resultText;
                    document.getElementById(`mc-vlookup-worksheet-r${foundRowIndex}c${searchColIndex}`).classList.add('highlight');
                    document.getElementById(`mc-vlookup-worksheet-r${foundRowIndex}c${resultColIndex}`).classList.add('highlight');
                } else {
                    mcVResultOutput.textContent = '#REF!';
                }
            } else {
                mcVResultOutput.textContent = '#N/A';
            }
        }


        // --- HLOOKUP LOGIC ---
        const hlookupSearchInput = document.getElementById('hlookup-search-value');
        const hlookupRangeInput = document.getElementById('hlookup-range-input');
        const hlookupIndexInput = document.getElementById('hlookup-index-num');
        const hlookupFormulaInput = document.getElementById('hlookup-formula-input');

        function updateHlookupFormula() {
            const searchValue = hlookupSearchInput.value.trim();
            const tableRange = hlookupRangeInput.value.trim();
            const indexNum = parseInt(hlookupIndexInput.value);
            if(searchValue && tableRange) {
                hlookupFormulaInput.value = `=HLOOKUP("${searchValue}"; ${tableRange}; ${indexNum}; FALSE)`;
            } else {
                hlookupFormulaInput.value = '';
            }
            runHlookup();
        }

        function runHlookup() {
            clearHighlights('hlookup-worksheet');
            const formula = hlookupFormulaInput.value;
            const regex = /=HLOOKUP\("([^"]+)"\s*;\s*([$A-Z0-9:]+)\s*;\s*(\d+)\s*;\s*FALSE\)/i;
            const match = formula.match(regex);

            if (match) {
                const searchValue = match[1];
                const rangeStr = match[2];
                const indexNum = parseInt(match[3]);

                if(document.activeElement !== hlookupSearchInput) hlookupSearchInput.value = searchValue;
                if(document.activeElement !== hlookupRangeInput) hlookupRangeInput.value = rangeStr;
                if(document.activeElement !== hlookupIndexInput) hlookupIndexInput.value = indexNum;
                
                const parsedRange = parseRange(rangeStr);
                 if (!parsedRange) {
                    document.getElementById('hlookup-result-output').textContent = '#ERROR!';
                    return;
                }

                for (let r = parsedRange.startRow -1; r <= parsedRange.endRow -1; r++) {
                    for (let c = parsedRange.startCol; c <= parsedRange.endCol; c++) {
                        const cell = document.getElementById(`hlookup-worksheet-r${r}c${c}`);
                        if (cell) cell.classList.add('highlight-range');
                    }
                }
                
                const searchRowIndex = parsedRange.startRow -1;
                let foundColIndex = -1;

                for (let c = parsedRange.startCol; c <= parsedRange.endCol; c++) {
                    if (dataHorizontal.rows[searchRowIndex] && dataHorizontal.rows[searchRowIndex][c] && String(dataHorizontal.rows[searchRowIndex][c]).toLowerCase() === searchValue.toLowerCase()) {
                        foundColIndex = c;
                        break;
                    }
                }

                if (foundColIndex !== -1) {
                    const resultRowIndex = parsedRange.startRow + indexNum - 2;
                    if(resultRowIndex >= (parsedRange.startRow -1) && resultRowIndex <= (parsedRange.endRow -1)) {
                        const result = dataHorizontal.rows[resultRowIndex][foundColIndex];
                         let resultText = result;
                        if (typeof result === 'number') {
                            if (resultRowIndex === 4) { // Baris Harga
                                resultText = 'Rp ' + result.toLocaleString('id-ID');
                            }
                        }
                        document.getElementById('hlookup-result-output').textContent = resultText;

                        document.getElementById(`hlookup-worksheet-r${searchRowIndex}c${foundColIndex}`).classList.add('highlight');
                        document.getElementById(`hlookup-worksheet-r${resultRowIndex}c${foundColIndex}`).classList.add('highlight');
                    } else {
                        document.getElementById('hlookup-result-output').textContent = '#REF!';
                    }
                } else {
                    document.getElementById('hlookup-result-output').textContent = '#N/A';
                }
            } else {
                document.getElementById('hlookup-result-output').textContent = '#ERROR!';
            }
        }

        // --- XLOOKUP LOGIC ---
        const xlookupSearchInput = document.getElementById('xlookup-search-value');
        const xlookupSearchRangeInput = document.getElementById('xlookup-search-range');
        const xlookupResultRangeInput = document.getElementById('xlookup-result-range');
        const xlookupFormulaInput = document.getElementById('xlookup-formula-input');

        function updateXlookupFormula() {
            const searchValue = xlookupSearchInput.value.trim();
            const searchCol = xlookupSearchRangeInput.value.trim();
            const resultCol = xlookupResultRangeInput.value.trim();
            if(searchValue && searchCol && resultCol) {
                xlookupFormulaInput.value = `=XLOOKUP("${searchValue}"; ${searchCol}; ${resultCol})`;
            } else {
                xlookupFormulaInput.value = '';
            }
            runXlookup();
        }

        function runXlookup() {
            clearHighlights('xlookup-worksheet');
            const formula = xlookupFormulaInput.value;
            const regex = /=XLOOKUP\("([^"]+)"\s*;\s*([$A-Z0-9:]+)\s*;\s*([$A-Z0-9:]+)\)/i;
            const match = formula.match(regex);
            
            if (match) {
                const searchValue = match[1];
                const searchRangeStr = match[2];
                const resultRangeStr = match[3];

                if(document.activeElement !== xlookupSearchInput) xlookupSearchInput.value = searchValue;
                if(document.activeElement !== xlookupSearchRangeInput) xlookupSearchRangeInput.value = searchRangeStr;
                if(document.activeElement !== xlookupResultRangeInput) xlookupResultRangeInput.value = resultRangeStr;

                const parsedSearchRange = parseRange(searchRangeStr);
                const parsedResultRange = parseRange(resultRangeStr);

                if (!parsedSearchRange || !parsedResultRange) {
                    document.getElementById('xlookup-result-output').textContent = '#ERROR!';
                    return;
                }

                for (let r = parsedSearchRange.startRow-1; r <= parsedSearchRange.endRow-1; r++) {
                    for (let c = parsedSearchRange.startCol; c <= parsedSearchRange.endCol; c++) {
                         const cell = document.getElementById(`xlookup-worksheet-r${r}c${c}`);
                         if (cell) cell.classList.add('highlight-range');
                    }
                }
                 for (let r = parsedResultRange.startRow-1; r <= parsedResultRange.endRow-1; r++) {
                    for (let c = parsedResultRange.startCol; c <= parsedResultRange.endCol; c++) {
                         const cell = document.getElementById(`xlookup-worksheet-r${r}c${c}`);
                         if (cell) cell.classList.add('highlight-result-range');
                    }
                }

                const searchColIndex = parsedSearchRange.startCol;
                let foundRowIndex = -1;

                for(let r = parsedSearchRange.startRow - 1; r <= parsedSearchRange.endRow - 1; r++) {
                     if (dataVertical.rows[r] && dataVertical.rows[r][searchColIndex] && String(dataVertical.rows[r][searchColIndex]).toLowerCase() === searchValue.toLowerCase()) {
                        foundRowIndex = r;
                        break;
                    }
                }
                
                if (foundRowIndex !== -1) {
                     const resultColIndex = parsedResultRange.startCol;
                     const result = dataVertical.rows[foundRowIndex][resultColIndex];
                     let resultText = result;
                     if (typeof result === 'number') {
                        if (resultColIndex === 5) { // Harga
                            resultText = 'Rp ' + result.toLocaleString('id-ID');
                        }
                    }
                    document.getElementById('xlookup-result-output').textContent = resultText;
                    
                    document.getElementById(`xlookup-worksheet-r${foundRowIndex}c${searchColIndex}`).classList.add('highlight');
                    document.getElementById(`xlookup-worksheet-r${foundRowIndex}c${resultColIndex}`).classList.add('highlight');
                } else {
                    document.getElementById('xlookup-result-output').textContent = '#N/A';
                }
            } else {
                document.getElementById('xlookup-result-output').textContent = '#ERROR!';
            }
        }

        // --- MULTI-CRITERIA XLOOKUP ---
        const mcXlookupSearch1 = document.getElementById('mc-xlookup-search-value1');
        const mcXlookupSearch2 = document.getElementById('mc-xlookup-search-value2');
        const mcXlookupResultRange = document.getElementById('mc-xlookup-result-range');
        const mcXlookupFormulaOutput = document.getElementById('mc-xlookup-formula-output');
        const mcXlookupResultOutput = document.getElementById('mc-xlookup-result-output');

        function runMultiCriteriaXlookup() {
            clearHighlights('mc-xlookup-worksheet');
            const searchValue1 = mcXlookupSearch1.value.trim();
            const searchValue2 = mcXlookupSearch2.value.trim();
            const resultRangeStr = mcXlookupResultRange.value.trim();
            
            const searchRange1Str = '$B$2:$B$12'; // Nama Barang
            const searchRange2Str = '$C$2:$C$12'; // Kategori

            mcXlookupFormulaOutput.textContent = `=XLOOKUP(1, (${searchRange1Str}="${searchValue1}")*(${searchRange2Str}="${searchValue2}"), ${resultRangeStr})`;
            
            const parsedResultRange = parseRange(resultRangeStr);
            if (!searchValue1 || !searchValue2 || !parsedResultRange) {
                mcXlookupResultOutput.textContent = '#N/A';
                return;
            }

            const searchCol1Index = 2; // Nama Barang -> Column B in dataVertical.rows
            const searchCol2Index = 3; // Kategori -> Column C in dataVertical.rows
            let foundRowIndex = -1;
            
            for (let r = 1; r < dataVertical.rows.length; r++) { // Start from 1 to skip header
                const rowData = dataVertical.rows[r];
                if(rowData && String(rowData[searchCol1Index]).toLowerCase() === searchValue1.toLowerCase() && String(rowData[searchCol2Index]).toLowerCase() === searchValue2.toLowerCase()){
                    foundRowIndex = r;
                    break;
                }
            }

            // Highlighting
            const searchCol1CellIndex = colLetterToCellIndex('B');
            const searchCol2CellIndex = colLetterToCellIndex('C');
            for(let r = 1; r < dataVertical.rows.length; r++) {
                const cell1 = document.getElementById(`mc-xlookup-worksheet-r${r}c${searchCol1CellIndex}`);
                if(cell1) cell1.classList.add('highlight-range');
                const cell2 = document.getElementById(`mc-xlookup-worksheet-r${r}c${searchCol2CellIndex}`);
                if(cell2) cell2.classList.add('highlight-range');
                const resultCell = document.getElementById(`mc-xlookup-worksheet-r${r}c${parsedResultRange.startCol}`);
                if(resultCell) resultCell.classList.add('highlight-result-range');
            }
            

            if(foundRowIndex !== -1) {
                const resultColIndex = parsedResultRange.startCol;
                const result = dataVertical.rows[foundRowIndex][resultColIndex];
                let resultText = result;
                if (typeof result === 'number') {
                    if (resultColIndex === 5) { // Harga is column E, cellIndex 5
                        resultText = 'Rp ' + result.toLocaleString('id-ID');
                    }
                }
                mcXlookupResultOutput.textContent = resultText;
                
                const foundCell1 = document.getElementById(`mc-xlookup-worksheet-r${foundRowIndex}c${searchCol1CellIndex}`);
                if(foundCell1) foundCell1.classList.add('highlight');

                const foundCell2 = document.getElementById(`mc-xlookup-worksheet-r${foundRowIndex}c${searchCol2CellIndex}`);
                if(foundCell2) foundCell2.classList.add('highlight');
                
                const resultCell = document.getElementById(`mc-xlookup-worksheet-r${foundRowIndex}c${resultColIndex}`);
                if(resultCell) resultCell.classList.add('highlight');

            } else {
                mcXlookupResultOutput.textContent = '#N/A';
            }
        }


        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {

            createWorksheet('vlookup-worksheet', dataVertical);
            createWorksheet('mc-vlookup-worksheet', dataVerticalWithHelper);
            createWorksheet('hlookup-worksheet', dataHorizontal);
            createWorksheet('xlookup-worksheet', dataVertical);
            createWorksheet('mc-xlookup-worksheet', dataVertical);


            vlookupSearchInput.addEventListener('input', updateVlookupFormula);
            vlookupRangeInput.addEventListener('input', updateVlookupFormula);
            vlookupIndexInput.addEventListener('input', updateVlookupFormula);
            vlookupFormulaInput.addEventListener('input', runVlookup);

            mcVSearch1.addEventListener('input', runMultiCriteriaVlookup);
            mcVSearch2.addEventListener('input', runMultiCriteriaVlookup);
            mcVIndex.addEventListener('input', runMultiCriteriaVlookup);
            
            hlookupSearchInput.addEventListener('input', updateHlookupFormula);
            hlookupRangeInput.addEventListener('input', updateHlookupFormula);
            hlookupIndexInput.addEventListener('input', updateHlookupFormula);
            hlookupFormulaInput.addEventListener('input', runHlookup);

            xlookupSearchInput.addEventListener('input', updateXlookupFormula);
            xlookupSearchRangeInput.addEventListener('input', updateXlookupFormula);
            xlookupResultRangeInput.addEventListener('input', updateXlookupFormula);
            xlookupFormulaInput.addEventListener('input', runXlookup);

            mcXlookupSearch1.addEventListener('input', runMultiCriteriaXlookup);
            mcXlookupSearch2.addEventListener('input', runMultiCriteriaXlookup);
            mcXlookupResultRange.addEventListener('input', runMultiCriteriaXlookup);

            // Tab logic
            const showXlookupBtn = document.getElementById('show-xlookup-mc');
            const showVlookupBtn = document.getElementById('show-vlookup-mc');
            const xlookupContent = document.getElementById('xlookup-mc-content');
            const vlookupContent = document.getElementById('vlookup-mc-content');

            showXlookupBtn.addEventListener('click', () => {
                xlookupContent.classList.remove('hidden');
                vlookupContent.classList.add('hidden');
                showXlookupBtn.classList.add('active-tab');
                showVlookupBtn.classList.remove('active-tab');
            });

            showVlookupBtn.addEventListener('click', () => {
                vlookupContent.classList.remove('hidden');
                xlookupContent.classList.add('hidden');
                showVlookupBtn.classList.add('active-tab');
                showXlookupBtn.classList.remove('active-tab');
            });


            // Initial population
            vlookupSearchInput.value = 'P005';
            vlookupRangeInput.value = '$A$2:$E$12';
            vlookupIndexInput.value = 5; // To get Harga
            
            mcVSearch1.value = 'Mouse Optik G5';
            mcVSearch2.value = 'Gaming';
            mcVIndex.value = 6;

            hlookupSearchInput.value = 'P007';
            hlookupRangeInput.value = '$B$1:$L$5';
            hlookupIndexInput.value = 5; // To get Harga
            
            xlookupSearchInput.value = 'P010';
            xlookupSearchRangeInput.value = '$A$2:$A$12';
            xlookupResultRangeInput.value = '$E$2:$E$12';
            
            mcXlookupSearch1.value = 'Mouse Optik G5';
            mcXlookupSearch2.value = 'Gaming';
            mcXlookupResultRange.value = '$E$2:$E$12';
            
            updateVlookupFormula();
            runMultiCriteriaVlookup();
            updateHlookupFormula();
            updateXlookupFormula();
            runMultiCriteriaXlookup();
        });
    </script>

</body>
</html>

