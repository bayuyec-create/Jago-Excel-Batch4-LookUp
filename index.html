<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Infografis Interaktif: Belajar Fungsi LookUp di Excel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://css.gg/css?=|check|code" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            scroll-behavior: smooth;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }
        .excel-grid {
            display: grid;
            border-left: 1px solid #d1d5db;
            border-top: 1px solid #d1d5db;
            width: fit-content;
        }
        .excel-cell {
            background-color: white;
            padding: 0.5rem;
            font-size: 0.875rem;
            min-height: 38px;
            display: flex;
            align-items: center;
            border-right: 1px solid #d1d5db;
            border-bottom: 1px solid #d1d5db;
        }
        .excel-header {
            background-color: #f3f4f6;
            font-weight: bold;
            text-align: center;
            justify-content: center;
        }
        .interactive-input {
            width: 100%;
            border: 2px solid #58508d;
            border-radius: 0.375rem;
            padding: 0.25rem 0.5rem;
        }
         .interactive-input:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(88, 80, 141, 0.3);
        }
        .highlight {
            background-color: rgba(255, 234, 0, 0.4) !important;
            transition: background-color 0.3s ease-in-out;
        }
        .formula-part {
            font-weight: bold;
            color: #003f5c;
        }
        .formula-input {
            font-family: monospace;
            color: #003f5c;
            background-color: #eef2ff;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="container mx-auto p-4 md:p-8">

        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-6xl font-black text-[#003f5c] mb-2">Pusing Cari Data di Excel?</h1>
            <p class="text-xl md:text-2xl text-[#58508d]">Kenali Jagoan Pencari Data: Fungsi <span class="font-bold">LOOKUP</span>!</p>
        </header>

        <main class="space-y-10">

            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-2xl font-bold text-[#003f5c] mb-4">Apa itu Fungsi LookUp?</h2>
                <p class="text-base">Bayangkan kamu punya asisten super cepat. Kamu sebut nama, dia langsung berikan infonya. Itulah fungsi <span class="font-bold">LookUp</span> di Excel. Ia bertugas untuk mencari sebuah nilai (kata kunci) di dalam tabel, lalu mengambil data lain yang berhubungan dari baris atau kolom yang sama. Lupakan cara manual, saatnya bekerja cerdas!</p>
            </div>

            <!-- VLOOKUP Section -->
            <div id="vlookup-playground" class="bg-white rounded-lg shadow-lg p-6 scroll-mt-20">
                <h2 class="text-2xl font-bold text-center text-[#bc5090] mb-2">Arena Praktik: VLOOKUP (Si Vertikal)</h2>
                <p class="text-center text-gray-600 mb-6">Mencari data di tabel yang disusun menurun. Ingat, kolom pencarian <span class="font-bold">harus</span> di paling kiri!</p>
                <div class="mb-8 border-b pb-6">
                    <h3 class="font-bold text-lg text-[#bc5090] mb-3">Bedah Rumus VLOOKUP</h3>
                    <p class="bg-gray-100 p-3 rounded-md text-center text-sm mb-4">
                        <code class="break-words">=VLOOKUP(<span class="formula-part">nilai_dicari</span>; <span class="formula-part">tabel_data</span>; <span class="formula-part">kolom_ke_berapa</span>; <span class="formula-part">FALSE</span>)</code>
                    </p>
                    <ul class="text-sm space-y-2">
                        <li><span class="formula-part">nilai_dicari</span>: "Kata kunci" yang mau kamu cari (misal: "P005").</li>
                        <li><span class="formula-part">tabel_data</span>: Area tabel tempat datamu berada. Kolom <span class="font-bold">nilai_dicari</span> harus ada di paling kiri area ini.</li>
                        <li><span class="formula-part">kolom_ke_berapa</span>: Kamu mau ambil data dari kolom ke berapa (dihitung dari kiri, kolom pertama = 1, kedua = 2, dst).</li>
                        <li><span class="formula-part">FALSE</span>: Perintah agar Excel mencari yang sama persis. Hampir selalu pakai ini.</li>
                    </ul>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-5 gap-8">
                    <div class="lg:col-span-2">
                        <div class="bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg p-4 space-y-4">
                            <div>
                                <label for="vlookup-search-value" class="font-semibold block mb-1">1. Cari ID Produk:</label>
                                <input type="text" id="vlookup-search-value" placeholder="Ketik: P005" class="interactive-input">
                            </div>
                            <div>
                                <label for="vlookup-index-num" class="font-semibold block mb-1">2. Ambil Data dari Kolom ke-?</label>
                                <input type="number" id="vlookup-index-num" value="2" min="2" max="4" class="interactive-input">
                            </div>
                            <div>
                                <p class="font-semibold">Rumus (Bisa Diedit):</p>
                                <input type="text" id="vlookup-formula-input" class="interactive-input formula-input w-full p-2 rounded-md text-sm break-words">
                            </div>
                            <div>
                                <p class="font-semibold">Hasil:</p>
                                <div id="vlookup-result-output" class="bg-green-100 border border-green-400 p-2 rounded-md font-bold text-green-800 min-h-[40px]"></div>
                            </div>
                        </div>
                    </div>
                    <div class="lg:col-span-3 overflow-x-auto">
                        <p class="font-semibold mb-2 text-center">Tabel Inventaris Barang</p>
                        <div id="vlookup-worksheet" class="mx-auto"></div>
                    </div>
                </div>
            </div>
            
            <!-- HLOOKUP Section -->
            <div id="hlookup-playground" class="bg-white rounded-lg shadow-lg p-6 scroll-mt-20">
                <h2 class="text-2xl font-bold text-center text-[#ff6361] mb-2">Arena Praktik: HLOOKUP (Si Horizontal)</h2>
                <p class="text-center text-gray-600 mb-6">Mencari data di tabel yang disusun mendatar. Baris pencarian <span class="font-bold">harus</span> di paling atas!</p>
                <div class="mb-8 border-b pb-6">
                    <h3 class="font-bold text-lg text-[#ff6361] mb-3">Bedah Rumus HLOOKUP</h3>
                    <p class="bg-gray-100 p-3 rounded-md text-center text-sm mb-4">
                        <code class="break-words">=HLOOKUP(<span class="formula-part">nilai_dicari</span>; <span class="formula-part">tabel_data</span>; <span class="formula-part">baris_ke_berapa</span>; <span class="formula-part">FALSE</span>)</code>
                    </p>
                    <ul class="text-sm space-y-2">
                        <li><span class="formula-part">nilai_dicari</span>: "Kata kunci" yang mau kamu cari (misal: "P007").</li>
                        <li><span class="formula-part">tabel_data</span>: Area tabel tempat datamu berada. Baris <span class="font-bold">nilai_dicari</span> harus ada di paling atas area ini.</li>
                        <li><span class="formula-part">baris_ke_berapa</span>: Kamu mau ambil data dari baris ke berapa (dihitung dari atas, baris pertama = 1, kedua = 2, dst).</li>
                        <li><span class="formula-part">FALSE</span>: Perintah agar Excel mencari yang sama persis.</li>
                    </ul>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-5 gap-8">
                    <div class="lg:col-span-2">
                         <div class="bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg p-4 space-y-4">
                            <div>
                                <label for="hlookup-search-value" class="font-semibold block mb-1">1. Cari ID Produk:</label>
                                <input type="text" id="hlookup-search-value" placeholder="Ketik: P007" class="interactive-input">
                            </div>
                            <div>
                                <label for="hlookup-index-num" class="font-semibold block mb-1">2. Ambil Data dari Baris ke-?</label>
                                <input type="number" id="hlookup-index-num" value="2" min="2" max="4" class="interactive-input">
                            </div>
                            <div>
                                <p class="font-semibold">Rumus (Bisa Diedit):</p>
                                <input type="text" id="hlookup-formula-input" class="interactive-input formula-input w-full p-2 rounded-md text-sm break-words">
                            </div>
                            <div>
                                <p class="font-semibold">Hasil:</p>
                                <div id="hlookup-result-output" class="bg-green-100 border border-green-400 p-2 rounded-md font-bold text-green-800 min-h-[40px]"></div>
                            </div>
                        </div>
                    </div>
                    <div class="lg:col-span-3 overflow-x-auto">
                        <p class="font-semibold mb-2 text-center">Tabel Inventaris Barang</p>
                        <div id="hlookup-worksheet" class="mx-auto"></div>
                    </div>
                </div>
            </div>

            <!-- XLOOKUP Section -->
            <div id="xlookup-playground" class="bg-white rounded-lg shadow-lg p-6 scroll-mt-20">
                <h2 class="text-2xl font-bold text-center text-[#ffa600] mb-2">Arena Praktik: XLOOKUP (Si Fleksibel)</h2>
                <p class="text-center text-gray-600 mb-6">Jagoan baru yang bebas! Bisa mencari di kolom mana saja dan mengambil data dari mana saja.</p>
                <div class="mb-8 border-b pb-6">
                    <h3 class="font-bold text-lg text-[#ffa600] mb-3">Bedah Rumus XLOOKUP</h3>
                    <p class="bg-gray-100 p-3 rounded-md text-center text-sm mb-4">
                        <code class="break-words">=XLOOKUP(<span class="formula-part">nilai_dicari</span>; <span class="formula-part">kolom_pencarian</span>; <span class="formula-part">kolom_hasil</span>)</code>
                    </p>
                    <ul class="text-sm space-y-2">
                        <li><span class="formula-part">nilai_dicari</span>: "Kata kunci" yang mau kamu cari (misal: "P010").</li>
                        <li><span class="formula-part">kolom_pencarian</span>: Cukup blok <span class="font-bold">satu kolom</span> tempat kamu mencari. Tidak harus di paling kiri!</li>
                        <li><span class="formula-part">kolom_hasil</span>: Cukup blok <span class="font-bold">satu kolom</span> tempat data yang mau kamu ambil berada.</li>
                    </ul>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-5 gap-8">
                    <div class="lg:col-span-2">
                         <div class="bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg p-4 space-y-4">
                            <div>
                                <label for="xlookup-search-value" class="font-semibold block mb-1">1. Cari ID Produk:</label>
                                <input type="text" id="xlookup-search-value" placeholder="Ketik: P010" class="interactive-input">
                            </div>
                            <div>
                                <label for="xlookup-index-num" class="font-semibold block mb-1">2. Ambil Data dari Kolom?</label>
                                <select id="xlookup-index-num" class="interactive-input w-full">
                                    <option value="2">Nama Barang</option>
                                    <option value="3">Kategori</option>
                                    <option value="4">Harga</option>
                                </select>
                            </div>
                            <div>
                                <p class="font-semibold">Rumus (Bisa Diedit):</p>
                                <input type="text" id="xlookup-formula-input" class="interactive-input formula-input w-full p-2 rounded-md text-sm break-words">
                            </div>
                            <div>
                                <p class="font-semibold">Hasil:</p>
                                <div id="xlookup-result-output" class="bg-green-100 border border-green-400 p-2 rounded-md font-bold text-green-800 min-h-[40px]"></div>
                            </div>
                        </div>
                    </div>
                    <div class="lg:col-span-3 overflow-x-auto">
                        <p class="font-semibold mb-2 text-center">Tabel Inventaris Barang</p>
                        <div id="xlookup-worksheet" class="mx-auto"></div>
                    </div>
                </div>
            </div>

            <!-- Kapan Harus Pakai? Section -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-2xl font-bold text-center text-[#003f5c] mb-4">Kapan Harus Pakai yang Mana?</h2>
                <p class="text-center text-gray-600 mb-8 max-w-3xl mx-auto">Setiap fungsi punya "spesialisasi"-nya masing-masing. Pilihlah yang paling sesuai dengan format tabel dan versi Excel-mu.</p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <!-- VLOOKUP Card -->
                    <div class="border-2 border-[#bc5090] rounded-lg p-4 flex flex-col">
                        <h3 class="text-xl font-bold text-[#bc5090] mb-3 text-center">VLOOKUP</h3>
                        <p class="font-semibold text-center mb-3">Gunakan Ketika...</p>
                        <p class="text-sm text-gray-700 mb-4 flex-grow">Tabel datamu tersusun **vertikal** (menurun) dan kolom pencarian berada di **paling kiri** dari area data.</p>
                        <div class="mt-auto">
                            <p class="text-xs bg-green-100 text-green-800 p-2 rounded"><span class="font-bold">Kelebihan:</span> Paling umum & banyak dikenal.</p>
                            <p class="text-xs bg-red-100 text-red-800 p-2 rounded mt-2"><span class="font-bold">Kekurangan:</span> Tidak fleksibel, rawan error jika kolom ditambah.</p>
                        </div>
                    </div>
                    <!-- HLOOKUP Card -->
                    <div class="border-2 border-[#ff6361] rounded-lg p-4 flex flex-col">
                        <h3 class="text-xl font-bold text-[#ff6361] mb-3 text-center">HLOOKUP</h3>
                        <p class="font-semibold text-center mb-3">Gunakan Ketika...</p>
                        <p class="text-sm text-gray-700 mb-4 flex-grow">Tabel datamu tersusun **horizontal** (mendatar) dan baris pencarian berada di **paling atas**.</p>
                         <div class="mt-auto">
                            <p class="text-xs bg-green-100 text-green-800 p-2 rounded"><span class="font-bold">Kelebihan:</span> Solusi untuk format tabel horizontal.</p>
                            <p class="text-xs bg-red-100 text-red-800 p-2 rounded mt-2"><span class="font-bold">Kekurangan:</span> Sama tidak fleksibelnya dengan VLOOKUP.</p>
                        </div>
                    </div>
                    <!-- XLOOKUP Card -->
                    <div class="border-2 border-[#ffa600] rounded-lg p-4 flex flex-col">
                        <h3 class="text-xl font-bold text-[#ffa600] mb-3 text-center">XLOOKUP</h3>
                        <p class="font-semibold text-center mb-3">Gunakan Ketika...</p>
                        <p class="text-sm text-gray-700 mb-4 flex-grow">Kamu ingin cara yang **paling mudah, aman, dan fleksibel**. Ini adalah pilihan terbaik jika kamu menggunakan Excel 2021 / Microsoft 365.</p>
                         <div class="mt-auto">
                            <p class="text-xs bg-green-100 text-green-800 p-2 rounded"><span class="font-bold">Kelebihan:</span> Sangat fleksibel, lebih mudah ditulis, anti error.</p>
                            <p class="text-xs bg-red-100 text-red-800 p-2 rounded mt-2"><span class="font-bold">Kekurangan:</span> Tidak tersedia di versi Excel lama.</p>
                        </div>
                    </div>
                </div>
            </div>

        </main>

        <footer class="text-center mt-12 py-4 border-t border-gray-300">
            <p class="text-gray-500">Infografis dibuat untuk mempermudah belajar Excel. Selamat mencoba!</p>
        </footer>

    </div>

    <script>
        const dataVertical = {
            headers: ['', 'A', 'B', 'C', 'D'],
            rows: [
                ['1', 'ID Produk', 'Nama Barang', 'Kategori', 'Harga'],
                ['2', 'P001', 'Laptop Pro 15', 'Komputer', 18500000],
                ['3', 'P002', 'Mouse Optik G5', 'Aksesoris', 350000],
                ['4', 'P003', 'Keyboard Mekanikal', 'Aksesoris', 850000],
                ['5', 'P004', 'Monitor LED 24"', 'Monitor', 2500000],
                ['6', 'P005', 'Webcam HD 1080p', 'Aksesoris', 650000],
                ['7', 'P006', 'Printer All-in-One', 'Printer', 1750000],
                ['8', 'P007', 'Hard Disk Eksternal 1TB', 'Penyimpanan', 950000],
                ['9', 'P008', 'Headset Gaming X', 'Audio', 1250000],
                ['10', 'P009', 'SSD NVMe 512GB', 'Penyimpanan', 1100000],
                ['11', 'P010', 'Speaker Bluetooth', 'Audio', 550000]
            ]
        };

        const dataHorizontal = {
            headers: ['', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K'],
            rows: [
                ['1', 'ID Produk', 'P001', 'P002', 'P003', 'P004', 'P005', 'P006', 'P007', 'P008', 'P009', 'P010'],
                ['2', 'Nama Barang', 'Laptop Pro 15', 'Mouse Optik G5', 'Keyboard Mekanikal', 'Monitor LED 24"', 'Webcam HD 1080p', 'Printer All-in-One', 'Hard Disk Eksternal 1TB', 'Headset Gaming X', 'SSD NVMe 512GB', 'Speaker Bluetooth'],
                ['3', 'Kategori', 'Komputer', 'Aksesoris', 'Aksesoris', 'Monitor', 'Aksesoris', 'Printer', 'Penyimpanan', 'Audio', 'Penyimpanan', 'Audio'],
                ['4', 'Harga', 18500000, 350000, 850000, 2500000, 650000, 1750000, 950000, 1250000, 1100000, 550000]
            ]
        };

        function createWorksheet(containerId, data) {
            const container = document.getElementById(containerId);
            let html = `<div class="excel-grid" style="grid-template-columns: 40px repeat(${data.headers.length - 1}, minmax(120px, 1fr));">`;
            
            data.headers.forEach(header => {
                html += `<div class="excel-cell excel-header" data-col-name="${header}">${header}</div>`;
            });

            data.rows.forEach((row, rowIndex) => {
                row.forEach((cell, cellIndex) => {
                    const isHeader = cellIndex === 0 || (containerId.includes('hlookup') && rowIndex === 0);
                    const cellId = `${containerId}-r${rowIndex}c${cellIndex}`;
                    let content = cell;
                    if (typeof cell === 'number' && cellIndex > 0) {
                        content = 'Rp ' + cell.toLocaleString('id-ID');
                    }
                    html += `<div class="excel-cell ${isHeader ? 'excel-header' : ''}" id="${cellId}">${content}</div>`;
                });
            });

            html += '</div>';
            container.innerHTML = html;
        }
        
        function clearHighlights(containerId) {
             document.querySelectorAll(`#${containerId} .excel-cell`).forEach(c => c.classList.remove('highlight'));
        }

        // --- VLOOKUP LOGIC ---
        const vlookupSearchInput = document.getElementById('vlookup-search-value');
        const vlookupIndexInput = document.getElementById('vlookup-index-num');
        const vlookupFormulaInput = document.getElementById('vlookup-formula-input');
        
        function updateVlookupFormula() {
            const searchValue = vlookupSearchInput.value.trim();
            const indexNum = parseInt(vlookupIndexInput.value);
            const tableRange = 'A2:D11';
            if (searchValue) {
                vlookupFormulaInput.value = `=VLOOKUP("${searchValue}"; ${tableRange}; ${indexNum}; FALSE)`;
            } else {
                vlookupFormulaInput.value = '';
            }
            runVlookup();
        }

        function runVlookup() {
            clearHighlights('vlookup-worksheet');
            const formula = vlookupFormulaInput.value;
            const regex = /=VLOOKUP\("([^"]+)"\s*;\s*[^;]+\s*;\s*(\d+)\s*;\s*FALSE\)/i;
            const match = formula.match(regex);

            if (match) {
                const searchValue = match[1];
                const indexNum = parseInt(match[2]);

                if(document.activeElement !== vlookupSearchInput) vlookupSearchInput.value = searchValue;
                if(document.activeElement !== vlookupIndexInput) vlookupIndexInput.value = indexNum;

                const searchData = dataVertical.rows.slice(1);
                const foundRowIndex = searchData.findIndex(row => row[1].toLowerCase() === searchValue.toLowerCase());

                if (foundRowIndex !== -1 && indexNum > 1 && indexNum <= searchData[0].length) {
                    const result = searchData[foundRowIndex][indexNum];
                    const resultText = (typeof result === 'number') ? 'Rp ' + result.toLocaleString('id-ID') : result;
                    document.getElementById('vlookup-result-output').textContent = resultText;
                    
                    document.getElementById(`vlookup-worksheet-r${foundRowIndex+1}c1`).classList.add('highlight');
                    document.getElementById(`vlookup-worksheet-r${foundRowIndex+1}c${indexNum}`).classList.add('highlight');
                } else {
                    document.getElementById('vlookup-result-output').textContent = '#N/A';
                }
            } else {
                 document.getElementById('vlookup-result-output').textContent = '#ERROR!';
            }
        }

        // --- HLOOKUP LOGIC ---
        const hlookupSearchInput = document.getElementById('hlookup-search-value');
        const hlookupIndexInput = document.getElementById('hlookup-index-num');
        const hlookupFormulaInput = document.getElementById('hlookup-formula-input');

        function updateHlookupFormula() {
            const searchValue = hlookupSearchInput.value.trim();
            const indexNum = parseInt(hlookupIndexInput.value);
            const tableRange = 'B1:K4';
            if(searchValue) {
                hlookupFormulaInput.value = `=HLOOKUP("${searchValue}"; ${tableRange}; ${indexNum}; FALSE)`;
            } else {
                hlookupFormulaInput.value = '';
            }
            runHlookup();
        }

        function runHlookup() {
            clearHighlights('hlookup-worksheet');
            const formula = hlookupFormulaInput.value;
            const regex = /=HLOOKUP\("([^"]+)"\s*;\s*[^;]+\s*;\s*(\d+)\s*;\s*FALSE\)/i;
            const match = formula.match(regex);

            if (match) {
                const searchValue = match[1];
                const indexNum = parseInt(match[2]);

                if(document.activeElement !== hlookupSearchInput) hlookupSearchInput.value = searchValue;
                if(document.activeElement !== hlookupIndexInput) hlookupIndexInput.value = indexNum;

                const searchData = dataHorizontal.rows[0].slice(1);
                const foundColIndex = searchData.findIndex(item => item.toLowerCase() === searchValue.toLowerCase());

                if (foundColIndex !== -1 && indexNum > 1 && indexNum <= dataHorizontal.rows.length) {
                    const result = dataHorizontal.rows[indexNum - 1][foundColIndex + 1];
                    const resultText = (typeof result === 'number') ? 'Rp ' + result.toLocaleString('id-ID') : result;
                    document.getElementById('hlookup-result-output').textContent = resultText;

                    document.getElementById(`hlookup-worksheet-r0c${foundColIndex+2}`).classList.add('highlight');
                    document.getElementById(`hlookup-worksheet-r${indexNum}c${foundColIndex+2}`).classList.add('highlight');
                } else {
                    document.getElementById('hlookup-result-output').textContent = '#N/A';
                }
            } else {
                document.getElementById('hlookup-result-output').textContent = '#ERROR!';
            }
        }

        // --- XLOOKUP LOGIC ---
        const xlookupSearchInput = document.getElementById('xlookup-search-value');
        const xlookupIndexSelect = document.getElementById('xlookup-index-num');
        const xlookupFormulaInput = document.getElementById('xlookup-formula-input');

        function updateXlookupFormula() {
            const searchValue = xlookupSearchInput.value.trim();
            const indexNum = parseInt(xlookupIndexSelect.value);
            const searchCol = 'A2:A11';
            const resultCol = `${String.fromCharCode(65 + indexNum)}2:${String.fromCharCode(65 + indexNum)}11`;
            if(searchValue) {
                xlookupFormulaInput.value = `=XLOOKUP("${searchValue}"; ${searchCol}; ${resultCol})`;
            } else {
                xlookupFormulaInput.value = '';
            }
            runXlookup();
        }

        function runXlookup() {
            clearHighlights('xlookup-worksheet');
            const formula = xlookupFormulaInput.value;
            const regex = /=XLOOKUP\("([^"]+)"\s*;\s*([A-Z0-9:]+)\s*;\s*([A-Z0-9:]+)\)/i;
            const match = formula.match(regex);
            
            if (match) {
                const searchValue = match[1];
                const resultColRange = match[3];
                const resultColLetter = resultColRange.charAt(0);
                const indexNum = resultColLetter.charCodeAt(0) - 65;

                if(document.activeElement !== xlookupSearchInput) xlookupSearchInput.value = searchValue;
                if(document.activeElement !== xlookupIndexSelect) xlookupIndexSelect.value = indexNum;

                const searchData = dataVertical.rows.slice(1);
                const foundRowIndex = searchData.findIndex(row => row[1].toLowerCase() === searchValue.toLowerCase());

                if (foundRowIndex !== -1 && indexNum > 0 && indexNum < searchData[0].length) {
                    const result = searchData[foundRowIndex][indexNum + 1];
                    const resultText = (typeof result === 'number') ? 'Rp ' + result.toLocaleString('id-ID') : result;
                    document.getElementById('xlookup-result-output').textContent = resultText;
                    
                    document.getElementById(`xlookup-worksheet-r${foundRowIndex+1}c1`).classList.add('highlight');
                    document.getElementById(`xlookup-worksheet-r${foundRowIndex+1}c${indexNum+1}`).classList.add('highlight');
                } else {
                    document.getElementById('xlookup-result-output').textContent = '#N/A';
                }
            } else {
                document.getElementById('xlookup-result-output').textContent = '#ERROR!';
            }
        }

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            createWorksheet('vlookup-worksheet', dataVertical);
            createWorksheet('hlookup-worksheet', dataHorizontal);
            createWorksheet('xlookup-worksheet', dataVertical);

            vlookupSearchInput.addEventListener('input', updateVlookupFormula);
            vlookupIndexInput.addEventListener('input', updateVlookupFormula);
            vlookupFormulaInput.addEventListener('input', runVlookup);
            
            hlookupSearchInput.addEventListener('input', updateHlookupFormula);
            hlookupIndexInput.addEventListener('input', updateHlookupFormula);
            hlookupFormulaInput.addEventListener('input', runHlookup);

            xlookupSearchInput.addEventListener('input', updateXlookupFormula);
            xlookupIndexSelect.addEventListener('change', updateXlookupFormula);
            xlookupFormulaInput.addEventListener('input', runXlookup);

            updateVlookupFormula();
            updateHlookupFormula();
            updateXlookupFormula();
        });
    </script>

</body>
</html>
